<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a phylomorphospace for a component from an analysis of multiple data blocks — phylomsPlot • morphoBlocks</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a phylomorphospace for a component from an analysis of multiple data blocks — phylomsPlot" />
<meta property="og:description" content="A plot to visualise the evolutionary relationships between specimens that are represented by values projected into a morphospace (e.g. Sidlauskas, 2008). Here the projected values are from a single component from an analysis of multiple data blocks. Rather than generating a two- or three-dimensional morphospace, this function plots consensus or principal component values against tree distance to show changes in the component value across the evolutionary history of the clade. The component values that are visualised using this function will either be from 1) the consensus space of an analysis performed with regularised consensus principal component analysis, or 2) will be from an analysis of a superblock (i.e. column-wise concatenation of individual data blocks) if principal component analysis was performed instead." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">morphoBlocks</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/morphoBlocksMethods.html">Comparison between PCA and RCPCA using simulated data</a>
    </li>
    <li>
      <a href="../articles/penguinWings.html">Constructing a morphospace for a partial-wing skeleton</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Downloads
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../downloads/morphoBlocks.pdf">PDF manual</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/aharmer/morphoBlocks">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a phylomorphospace for a component from an analysis of multiple data blocks</h1>
    
    <div class="hidden name"><code>phylomsPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A plot to visualise the evolutionary relationships between specimens that are represented by values projected into a morphospace (e.g. Sidlauskas, 2008). Here the projected values are from a single component from an analysis of multiple data blocks. Rather than generating a two- or three-dimensional morphospace, this function plots consensus or principal component values against tree distance to show changes in the component value across the evolutionary history of the clade. The component values that are visualised using this function will either be from 1) the consensus space of an analysis performed with regularised consensus principal component analysis, or 2) will be from an analysis of a superblock (i.e. column-wise concatenation of individual data blocks) if principal component analysis was performed instead.</p>
    </div>

    <pre class="usage"><span class='fu'>phylomsPlot</span><span class='op'>(</span>
  <span class='va'>result</span>,
  <span class='va'>phy</span>,
  <span class='va'>n.names</span>,
  comp <span class='op'>=</span> <span class='fl'>1</span>,
  pcol <span class='op'>=</span> <span class='cn'>NULL</span>,
  xlab <span class='op'>=</span> <span class='st'>"Time (Ma)"</span>,
  label <span class='op'>=</span> <span class='st'>"off"</span>,
  fsize <span class='op'>=</span> <span class='fl'>0.8</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>result</th>
      <td><p>result produced by the <code>analyseBlocks</code> function.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>a phylogenetic tree (class “phylo”) with <code>n</code> tips, where <code>n</code> is the number of samples in each block. Tip labels must be included and must correspond to the names of the samples in each block.</p></td>
    </tr>
    <tr>
      <th>n.names</th>
      <td><p>a vector of character strings where entries in the vector represent names of the <code>n</code> samples present in each block. IMPORTANT NOTE: The sequence of character strings in <code>n.names</code> must match the sequence that samples are named in each block, and the names must exactly match the tip labels in the phylogenetic tree. For example, consider a block containing data from five samples where the first, second and third rows of the block contain data from samples "A", "B" and "C", and the fourth and fifth rows contain data from samples "D" and "E". Consequently, 1) <code>n.names = c("A", "B", "C", "D", "E")</code>, 2) <code>phy</code> should only include five tips, and 3) <code>phy$tip.labels</code> should be "A", "B", "C", "D" and "E" (in any order).</p></td>
    </tr>
    <tr>
      <th>comp</th>
      <td><p>the component selected to be shown in the phylomorphospace plot. Default is component one. The selected component must be within the range of components calculated by <code>analyseBlocks</code>.</p></td>
    </tr>
    <tr>
      <th>pcol</th>
      <td><p>optional colour value (integer, hex code, colour name) or vector of colour values to be applied to the points in the phylomorphospace plot. If no value is specified then points will be coloured in a gradient from black to green according to their sequence in the data blocks. If a single integer is supplied (e.g. <code>pcol = 1</code> or <code>pcol = "red"</code> or <code>pcol = "#ffffff"</code> then all points will have the same colour. If a vector of length <em>n</em> is supplied (e.g. <code>pcol = 1:10</code>) then each point will be coloured by a value corresponding to its position in the vector.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>character string displayed along the horizontal axis of the phlyomorphospace plot. Default is "Time (Ma)".</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>a logical value indicating if the points in the phylomorphospace should be labelled using <code>n.names</code>. Default value is <code>off</code> (i.e. names are not shown).</p></td>
    </tr>
    <tr>
      <th>fsize</th>
      <td><p>size of the <code>n.names</code> labels if they are included in the plot. Default is 0.8.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>phylomsPlot</code> helps to visualise the result from the <code>analyseBlocks</code> function by presenting an evolutionary context for score values from a consensus space (for <code>option = "rcpca"</code> in <code>analyseBlocks</code>) or from a concatenated superblock (for <code>option = "pca"</code> in <code>analyseBlocks</code>).
<code>phylomsPlot</code> is a wrapper for <code>phylomorphospace</code> from the <code>phytools</code> package (Revell, 2012), which is in turn based on the projection of a phylogenetic tree into a morphospace by Sidlauskas (2008). The function <code>phylomsPlot</code> uses the <code>distRoot</code> function from the <code>adephylo</code> package (Jombart et al. 2010). <code>phylomsPlot</code> does not specifically use functions from the <code>ape</code> package (Paradis et al. 2004), but this package may be called to read <code>phy</code> into <span style="R">R</span>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jombart T, Balloux F, Dray S. 2010. adephylo: new tools for investigating the phylogenetic signal in biological traits. Bioinformatics 26: 1907–1909 https://doi.org/10.1093/bioinformatics/btq292</p>
<p>Paradis E, Claude J, Strimmer K. 2004. APE: Analyses of phylogenetics and evolution in <span style="R">R</span> language. Bioinformatics 20: 289–290 https://doi.org/10.1093/bioinformatics/btg412</p>
<p>Revell LJ. 2012. phytools: An <span style="R">R</span> package for phylogenetic comparative biology (and other things). Methods in Ecology and Evolution 3: 217–223 https://doi.org/10.1111/j.2041-210X.2011.00169.x</p>
<p>Sidlauskas B. 2008. Continuous and arrested morphological diversification in sister clades of characiform fishes: a phylomorphospace approach. Evolution 62: 3135–3156 https://doi.org/10.1111/j.1558-5646.2008.00519.x</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Simulate a phylogenetic tree with 20 tips</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/liamrevell/phytools'>phytools</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: ape</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: maps</span></div><div class='input'><span class='va'>phy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/phytools/man/pbtree.html'>pbtree</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>0.1</span>, n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># Simulate, combine and analyse two data blocks with 20 samples each</span>
<span class='va'>block1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dodecBlock.html'>dodecBlock</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>block2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='dodecBlock.html'>dodecBlock</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>blocklist</span> <span class='op'>&lt;-</span> <span class='fu'><a href='combineBlocks.html'>combineBlocks</a></span><span class='op'>(</span>blocks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>block1</span>, <span class='va'>block2</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'><a href='analyseBlocks.html'>analyseBlocks</a></span><span class='op'>(</span><span class='va'>blocklist</span><span class='op'>)</span>

<span class='co'># Simulate a vector of names (here just use the tip labels)</span>
<span class='va'>n.names</span> <span class='op'>&lt;-</span> <span class='va'>phy</span><span class='op'>$</span><span class='va'>tip.label</span>

<span class='co'># Generate phylomorphospace plot</span>
<span class='fu'>phylomsPlot</span><span class='op'>(</span><span class='va'>result</span>, <span class='va'>phy</span>, <span class='va'>n.names</span>, comp <span class='op'>=</span> <span class='fl'>1</span>, xlab <span class='op'>=</span> <span class='st'>"Tip to root distance"</span><span class='op'>)</span>
</div><div class='img'><img src='phylomsPlot-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Thomas, <a href='https://www.harmerlab.com/'>Aaron Harmer</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


